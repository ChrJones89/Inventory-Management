<!--

	This sample is meant to demonstrate the methods used to communicate with
	the Dymo Label Software via LabelServer Automation Server interface.

	Permission to use, copy, modify, and distribute this software for any
	purpose and without fee is hereby granted.

	Copyright 2007 DYMO Corporation
	
-->

<SCRIPT LANGUAGE="JavaScript">

var parent = external.menuArguments;
var doc = parent.document;
var sel = doc.selection;

if (sel.type == 'Text')
{
    var txt_range = sel.createRange();
    if (txt_range.text.length > 0)
    {
		ShowPrintWindow(txt_range.text);
    }
}
else
{
    alert("No text selected");
}

function ShowPrintWindow(txt)
{
	var url = "ieprintlabels.htm?param=" + txt;

	var wnd = window.open(url,"","left=100,top=100,width=450,height=360,resizable=0,location=0,menubar=0,scrollbars=0,status=0,toolbar=0", true);
	
	var _txtBuff = wnd.document.getElementById("TextArea1");
	_txtBuff.innerText = txt;
	
}


</SCRIPT>